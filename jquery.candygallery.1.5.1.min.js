/*
*	Candy Gallery			
*
*	@author:			Stephen Radford, Twitter: @steve228uk
*	@version:			1.5.1
*	@Last Update:		04.03.2012
*	@licence:			MIT (http://www.opensource.org/licenses/mit-license.php)
*						GPL	(http://www.gnu.org/licenses/gpl.html)
*	@documentation:		github.com/steve228uk/Candy-Gallery
*	@feedback:			steve228uk@gmail.com
*
*/

(function(a){a.fn.candygallery=function(b){var c={maxwidth:640,thumbwidth:80,thumbopacity:0.7,title:"true",changeon:"click",thumbposition:"after",fade:"true",fadespeed:500,nav:"true",nexttext:"&rarr;",prevtext:"&larr;",auto:"true",timeout:3000};var b=a.extend({},c,b);return this.each(function(){var f=a(this);var g=a(f).children("img:first-child").attr("src");var l=parseFloat(b.thumbwidth)+50;a(f).children("img").wrap("<li />");a(f).children("li").wrapAll('<ul class="gallery-ul" />');var k=a(f).children(".gallery-ul");var n=a(f).children(".gallery-ul").children("li").children("img");var h=a(f).children(".gallery-ul").children("li");a(n).attr("width",l);if(b.thumbposition=="after"){a(k).before('<div class="big-image"></div>')}else{a(k).after('<div class="big-image"></div>')}var j=a(f).children(".big-image");a('<img src="'+g+'" />').appendTo(j);if(b.title=="true"){a('<div class="gallery-title"></div>').appendTo(j);var e=a(j).children(".gallery-title");var i=a(k).children("li:first-child").children("img").attr("alt");a(e).text(i)}a(j).children("img").attr("width",b.maxwidth);a(h).css({width:b.thumbwidth+"px",height:b.thumbwidth+"px",opacity:b.thumbopacity});a(k).children("li:first-child").addClass("active-thumb");a(k).children("li:last-child").attr("id","candy-last");a(k).children("li:first-child").attr("id","candy-first");if(b.auto=="true"){function m(){var q=a(k).children(".active-thumb").next("li").children("img").attr("alt");var p=a(k).children(".active-thumb").next("li").children("img");if(a(k).children(".active-thumb").attr("id")=="candy-last"){var p=a(k).children("li:first").children("img");var q=a(k).children("li:first").children("img").attr("alt")}a(j).children(".candy-prev").show();if(b.fade=="true"){a(j).children("img").addClass("del-me").stop(true,true);a(".del-me").css({position:"relative","z-index":"2"});a(p).clone().appendTo(j);a(".del-me").siblings("img").addClass("temp");a(".del-me").fadeOut(b.fadespeed,function(){a(this).remove();a(".temp").removeClass("temp")});a(j).children("img").attr("width",b.maxwidth)}else{a(j).children("img").remove();a(p).clone().appendTo(j);a(j).children("img").attr("width",b.maxwidth)}if(b.title=="true"){var o=a(j).children(".gallery-title");a(o).text(q)}a(k).children(".active-thumb").removeClass("active-thumb");a(p).parent().addClass("active-thumb")}var d=setInterval(m,b.timeout)}if(b.nav=="true"){a('<a href="javascript:void(0);" class="candy-next" title="Next Image">'+b.nexttext+'</a><a href="javascript:void(0);" class="candy-prev" title="Previous Image">'+b.prevtext+"</a>").appendTo(j);a(j).children(".candy-next").click(function(){if(b.auto=="true"){clearInterval(d);d=setInterval(m,b.timeout)}var q=a(k).children(".active-thumb").next("li").children("img").attr("alt");var p=a(k).children(".active-thumb").next("li").children("img");if(a(k).children(".active-thumb").attr("id")=="candy-last"){var p=a(k).children("li:first").children("img");var q=a(k).children("li:first").children("img").attr("alt")}if(b.fade=="true"){a(j).children("img").addClass("del-me").stop(true,true);a(".del-me").css({position:"relative","z-index":"2"});a(p).clone().appendTo(j);a(".del-me").siblings("img").addClass("temp");a(".del-me").fadeOut(b.fadespeed,function(){a(this).remove();a(".temp").removeClass("temp")});a(j).children("img").attr("width",b.maxwidth)}else{a(j).children("img").remove();a(p).clone().appendTo(j);a(j).children("img").attr("width",b.maxwidth)}if(b.title=="true"){var o=a(j).children(".gallery-title");a(o).text(q)}a(k).children(".active-thumb").removeClass("active-thumb");a(p).parent().addClass("active-thumb")});a(j).children(".candy-prev").click(function(){if(b.auto=="true"){clearInterval(d);d=setInterval(m,b.timeout)}var r=a(k).children(".active-thumb").prev("li").children("img").attr("alt");var p=a(k).children(".active-thumb").prev("li").children("img");if(a(k).children(".active-thumb").attr("id")=="candy-last"){var p=a(k).children("li:first").children("img");var r=a(k).children("li:first").children("img").attr("alt")}var q=a(k).children(".active-thumb").prev("li").children("img").attr("src");a(j).children(".candy-next").show();if(b.fade=="true"){a(j).children("img").addClass("del-me").stop(true,true);a(".del-me").css({position:"relative","z-index":"2"});a(p).clone().appendTo(j);a(".del-me").siblings("img").addClass("temp");a(".del-me").fadeOut(b.fadespeed,function(){a(this).remove();a(".temp").removeClass("temp")});a(j).children("img").attr("width",b.maxwidth)}else{a(j).children("img").remove();a(p).clone().appendTo(j);a(j).children("img").attr("width",b.maxwidth)}if(b.title=="true"){var o=a(j).children(".gallery-title");a(o).text(r)}a(k).children(".active-thumb").removeClass("active-thumb");a(p).parent().addClass("active-thumb")})}a(n).bind("changeimg",function(){if(b.auto=="true"){clearInterval(d);d=setInterval(m,b.timeout)}var p=a(this).attr("alt");var o=a(this);if(b.fade=="true"){a(j).children("img").addClass("del-me").stop(true,true);a(".del-me").css({position:"relative","z-index":"2"});a(o).clone().appendTo(j);a(".del-me").siblings("img").addClass("temp");a(".del-me").fadeOut(b.fadespeed,function(){a(this).remove();a(".temp").removeClass("temp")});a(j).children("img").attr("width",b.maxwidth)}else{a(j).children("img").remove();a(o).clone().appendTo(j);a(j).children("img").attr("width",b.maxwidth)}a(k).children(".active-thumb").removeClass("active-thumb");a(this).parent().addClass("active-thumb");a(e).text("");a(e).text(p)});if(b.changeon=="click"){a(n).click(function(){a(this).trigger("changeimg")})}else{a(n).hover(function(){a(this).trigger("changeimg")})}})}})(jQuery);